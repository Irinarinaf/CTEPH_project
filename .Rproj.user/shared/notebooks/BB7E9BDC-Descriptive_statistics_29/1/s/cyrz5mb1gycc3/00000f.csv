"0",""
"0","data_end <- data %>%"
"0","  ungroup() %>% "
"0","  filter( rowSums(is.na(select(., -USUBJID))) < ncol(select(., -USUBJID)))"
"0",""
"0",""
"0","data_end <- data_end %>% "
"0","  group_by(USUBJID) %>% "
"0","  mutate(deathdt = as.POSIXct(deathdt)) %>% #перевод в формат POSIXct"
"0","  mutate(end = ifelse(!is.na(deathdt), deathdt, last_visit)) %>% "
"0","  #дата исключения пациента из исследования: смерть или последний визит"
"0","  mutate(end = as.POSIXct(end)) %>% #перевод в формат POSIXct"
"0","  mutate(end_bl = as.numeric(difftime( end, OS1_startdt, units = ""days"")) / 365.25) %>% "
"0","  mutate(HTdiag = ifelse(!is.na(PriorverifiedEarlierdt), PriorverifiedEarlierdt, first_visit)) %>% #дата диагностирования заболевания ХТЭЛГ: либо диагностика до включения либо дата первого визита"
"0","  mutate(HTdiag = as.POSIXct(HTdiag)) %>%  #перевод в формат POSIXct"
"0","  mutate(first_visit_0 = case_when(!is.na(end) & end == first_visit ~ first_visit,"
"0","                                   is.na(end) ~ NA,"
"0","                                   TRUE ~ NA)) %>% # чтобы отметить пациентов, которые пришли только на 1 визит"
"0","  mutate(first_visit_0_bl = as.numeric(difftime( first_visit_0, OS1_startdt, units = ""days"")) / 365.25) %>% "
"0","  mutate(first_visit_0 = as.POSIXct(first_visit_0)) %>% "
"0","  mutate(min_LAGdt = as.POSIXct(min_LAGdt)) %>% "
"0","  mutate(TTCDdt = as.POSIXct(TTCDdt)) %>% "
"0","  mutate(TTCDdt_n = case_when(TTCDdt == lastalivedt ~ NA,"
"0","                              TTCDdt >= deathdt ~ NA,"
"0","                                   TRUE ~ TTCDdt)) %>% "
"0","  mutate(TTCDdt_n = as.POSIXct(TTCDdt_n)) %>% "
"0","  mutate(OS1_startdt = as.POSIXct(OS1_startdt)) %>%"
"0","  mutate(first_visit_bl = as.numeric(difftime( first_visit, OS1_startdt, units = ""days"")) / 365.25) %>% "
"0","  mutate(ord =  first_visit_bl - end_bl) %>%  #порядок пациентов по Y"
"0","  mutate(DateTPE_bl = as.numeric(difftime( DateTPE, OS1_startdt, units = ""days"")) / 365.25) %>% "
"0","  mutate(min_LAGdt_bl = as.numeric(difftime( min_LAGdt, OS1_startdt, units = ""days"")) / 365.25) %>% "
"0","  mutate(TTCDdt_n_bl = as.numeric(difftime( TTCDdt_n, OS1_startdt, units = ""days"")) / 365.25) %>% "
"0","  mutate(death = ifelse(is.na(deathdt), ""The patient is alive"", ""The patient is dead"")) %>% "
"0","  mutate(BPAdate_bl = as.numeric(difftime( BPAdate, OS1_startdt, units = ""days"")) / 365.25)"
"0",""
"0",""
"0",""
"0",""
"0","data_end <- data_end %>%"
"0","  ungroup() %>% "
"0","  filter(!is.na(end) & rowSums(is.na(select(., -USUBJID))) < ncol(select(., -USUBJID))) "
"0",""
"0",""
"0",""
"0",""
"0",""
"0",""
